(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     52800,       1193]
NotebookOptionsPosition[     49658,       1138]
NotebookOutlinePosition[     50035,       1154]
CellTagsIndexPosition[     49992,       1151]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"training", " ", "=", " ", 
   RowBox[{"RandomSample", "[", 
    RowBox[{"ExampleData", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<MachineLearning\>\"", ",", "\"\<MNIST\>\""}], "}"}], ",", 
      "\"\<TrainingData\>\""}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tx", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"ImageData", ",", " ", 
       RowBox[{"training", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"60000", ",", " ", "1", ",", " ", "784"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "  ", "=", " ", 
   RowBox[{"training", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ty", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"60000", ",", " ", "1", ",", " ", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", "60000"}], ",", " ", 
   RowBox[{"i", "++"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"ty", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"1", "+", 
         RowBox[{"tt", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", " ", 
     "1"}], ";"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7391476528831434`*^9, 3.739147662570857*^9}, {
   3.7391477145539722`*^9, 3.739147714684647*^9}, {3.739183080713754*^9, 
   3.7391831066657753`*^9}, 3.739183747448804*^9, {3.739184778284623*^9, 
   3.739184778763136*^9}, {3.739184954794388*^9, 3.739184954966977*^9}, {
   3.739185135831162*^9, 3.739185135981758*^9}, 3.7391853386113033`*^9, {
   3.7391854738980036`*^9, 3.7391854743587885`*^9}, {3.739193995619089*^9, 
   3.73919407540515*^9}, {3.7391945731812906`*^9, 3.739194587588744*^9}, {
   3.739194885069962*^9, 3.739194885748148*^9}, {3.7391950576053534`*^9, 
   3.739195059603009*^9}, {3.739195748079439*^9, 3.7391957553340287`*^9}, {
   3.739196210135741*^9, 3.7391962131116*^9}, {3.7391963323332143`*^9, 
   3.7391963488889327`*^9}, {3.7391965059058313`*^9, 
   3.7391965140600157`*^9}, {3.73919668775113*^9, 3.739196735739766*^9}, {
   3.7391968366199503`*^9, 3.739196846786747*^9}, {3.7391969720546117`*^9, 
   3.7391969728135715`*^9}, {3.7391974770710597`*^9, 3.739197498586486*^9}, {
   3.7391984962743073`*^9, 3.739198524164669*^9}, {3.7391990570073442`*^9, 
   3.739199057161932*^9}, {3.7391992285952806`*^9, 3.7391992297053003`*^9}, {
   3.739199276255316*^9, 3.739199283873684*^9}, {3.739199395060211*^9, 
   3.7391993952068205`*^9}, {3.739202245926963*^9, 3.7392022485878224`*^9}, {
   3.7392043392551584`*^9, 3.739204349639889*^9}, 3.7392197918904486`*^9, {
   3.7392199663407097`*^9, 3.73921996880412*^9}, {3.7392201813644304`*^9, 
   3.7392201871918364`*^9}, {3.739220422004242*^9, 3.73922042573925*^9}, {
   3.739222405313574*^9, 3.7392224054881067`*^9}, {3.7392231658330665`*^9, 
   3.739223167106659*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"9ef69ac0-10de-4ab5-b332-39bce14ea535"],

Cell[BoxData[
 RowBox[{"(*", "  ", 
  RowBox[{"w0", "                ", 
   RowBox[{"(", 
    RowBox[{"inputdim", ",", " ", "hiddennodes"}], ")"}], "  ", "w1", "             ", 
   RowBox[{"(", 
    RowBox[{"hiddennodes", ",", " ", "outputnodes"}], ")"}], 
   "\[IndentingNewLine]", "   ", "l0", "                ", 
   RowBox[{"(", 
    RowBox[{"batchsize", ",", " ", "1", ",", "inputdim"}], ")"}], "             ",
    "l1", "             ", 
   RowBox[{"(", 
    RowBox[{"batchsize", ",", " ", "1", ",", " ", "hiddennodes"}], ")"}], "          ",
    "l2", "             ", 
   RowBox[{"(", 
    RowBox[{"batchsize", ",", " ", "1", ",", " ", "outputnodes"}], ")"}], 
   "\[IndentingNewLine]", " ", "l2Error", "             ", 
   RowBox[{"(", 
    RowBox[{"1", ",", " ", "outputnodes"}], ")"}], "         ", "l2Delta", "        ", 
   RowBox[{"(", 
    RowBox[{"1", ",", " ", "outputnodes"}], ")"}], "          ", "l1Error", "        ", 
   RowBox[{"(", 
    RowBox[{"1", ",", " ", "hiddennodes"}], ")"}], "\[IndentingNewLine]", " ",
    "l1Delta", "             ", 
   RowBox[{"(", 
    RowBox[{"1", ",", " ", "hiddennodes"}], ")"}], "         ", "g1", "             ", 
   RowBox[{"(", 
    RowBox[{"1", ",", " ", "hiddennodes"}], ")"}], "          ", "g0", "             ", 
   RowBox[{"(", 
    RowBox[{"inputdim", ",", " ", "outputnodes"}], ")"}], 
   "\[IndentingNewLine]", "   ", "l"}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7391835684223084`*^9, 3.7391835709997406`*^9}, {
  3.739183623925087*^9, 3.7391836288437996`*^9}, {3.7392042851519113`*^9, 
  3.73920430793499*^9}},ExpressionUUID->"e1a2b6d6-7ce8-4675-bec5-\
747d5309d469"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"learningrate", " ", "=", " ", "0.001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddennodes", " ", "=", " ", "512"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputnodes", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchsize", " ", "=", " ", "32"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterations", " ", "=", " ", 
   RowBox[{"Floor", "[", 
    RowBox[{"60000", "/", "batchsize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epochs", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", "0.99"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsilon", " ", "=", " ", "0.00000001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputdim", "  ", "=", " ", "784"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigmoid", "[", 
    RowBox[{"x_", ",", " ", "deriv_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"deriv", "\[Equal]", "True"}], ",", " ", 
     RowBox[{"Return", "[", 
      RowBox[{"x", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}]}], "]"}], ",", " ", 
     RowBox[{"Return", "[", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", "x"}], "]"}]}], ")"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"relu", "[", 
    RowBox[{"x_", ",", " ", "deriv_"}], "]"}], " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"deriv", "\[Equal]", "True"}], ",", " ", 
     RowBox[{"Return", "[", 
      RowBox[{"UnitStep", "[", "x", "]"}], "]"}], ",", " ", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"Abs", "[", "x", "]"}], "*", 
       RowBox[{"UnitStep", "[", "x", "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"softmax", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"deriv", "\[Equal]", "True"}], ",", " ", 
     RowBox[{"Return", "[", "]"}], ",", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"x", "-", " ", 
         RowBox[{"Max", "[", "x", "]"}]}], "]"}], "/", 
       RowBox[{"Total", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"x", "-", " ", 
          RowBox[{"Max", "[", "x", "]"}]}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MSE", "[", 
     RowBox[{"y_", ",", " ", "Y_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Mean", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "-", "Y"}], ")"}], "^", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Shape", " ", "of", " ", 
      RowBox[{"y", " ", "--"}]}], ">", " ", 
     RowBox[{"(", 
      RowBox[{"1", ",", "10"}], ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{"shape", " ", "of", " ", 
      RowBox[{"X", " ", "--"}]}], ">", " ", 
     RowBox[{"(", 
      RowBox[{"1", ",", " ", "10"}], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"crossEntropy", "[", 
      RowBox[{"X_", ",", " ", "y_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Total", "[", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"y", "*", 
              RowBox[{"Log", "[", 
               RowBox[{"X", "+", "epsilon"}], "]"}]}], ",", " ", 
             RowBox[{"{", "3", "}"}]}], "]"}], ",", " ", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dimensions", "[", "X", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"deltaCrossEntropy", "[", 
      RowBox[{"X_", ",", " ", "y_"}], "]"}], ":=", " ", 
     RowBox[{"Return", "[", 
      RowBox[{"X", " ", "-", " ", "y"}], "]"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7391992347224207`*^9, 3.739199250616897*^9}, {
   3.739199290224718*^9, 3.7391992933433743`*^9}, {3.739199824184043*^9, 
   3.7391998614538364`*^9}, {3.739200129966235*^9, 3.739200137133071*^9}, {
   3.739200372349378*^9, 3.739200449866604*^9}, {3.7392011899050555`*^9, 
   3.7392012082477903`*^9}, {3.7392014229770575`*^9, 
   3.7392014620410423`*^9}, {3.7392015265370393`*^9, 
   3.7392015501104665`*^9}, {3.7392017803112793`*^9, 
   3.7392018642865763`*^9}, {3.739202241827911*^9, 3.7392022994503*^9}, {
   3.739202363406682*^9, 3.739202388706999*^9}, {3.739203824337968*^9, 
   3.7392038616996794`*^9}, {3.7392047641688967`*^9, 3.739204768352705*^9}, {
   3.7392077232950788`*^9, 3.7392077260309114`*^9}, 3.7392139446281953`*^9, 
   3.739217301910493*^9, 3.7392176547599916`*^9, {3.739223169208037*^9, 
   3.7392231711827908`*^9}, {3.7392232205686255`*^9, 3.7392232207920446`*^9}, 
   3.7392234292154026`*^9, {3.739224110146385*^9, 3.7392241383924274`*^9}, {
   3.7392241827388687`*^9, 3.7392241829598565`*^9}, 3.739225027792868*^9, 
   3.73922506831246*^9, 3.739235061893123*^9},
 CellLabel->
  "In[122]:=",ExpressionUUID->"a3942673-5bd5-4f48-b4fc-55dea3b9de20"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"runNet", "[", 
    RowBox[{"net_", ",", " ", "tx_"}], "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"sigmoid", "[", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"relu", "[", 
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"tx", ",", " ", 
            RowBox[{"net", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"deriv", "=", "False"}]}], "]"}], ",", " ", 
        RowBox[{"net", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"deriv", "=", "False"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7391992534064465`*^9, 3.73919925968865*^9}, 
   3.7391993625182734`*^9, {3.7392184160600586`*^9, 3.7392184346226196`*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"44e5af52-d1a2-46ee-82a9-0363e6f9e79e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"buildNet", "[", 
    RowBox[{
    "tx_", ",", " ", "ty_", ",", " ", "b1_", ",", " ", "b2_", ",", " ", 
     "epsilon_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", " ", "w0", ",", " ", "w1", ",", "l2Error", ",", " ", 
       "l2Delta", ",", " ", "l1Error", ",", " ", "l1Delta", ",", " ", "g1", 
       ",", " ", "g0", ",", " ", "l0", ",", " ", "l1", ",", " ", "l2", ",", 
       "l2M", ",", " ", "l1M", ",", " ", "l2V", ",", " ", "l1V", ",", " ", 
       "l1MC", ",", " ", "l1VC", ",", " ", "l2MC", ",", " ", "l2VC", ",", " ",
        "w1UDT", ",", " ", "w0UDT"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mininet", " ", "=", " ", 
       RowBox[{"NetChain", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LinearLayer", "[", "hiddennodes", "]"}], ",", " ", "Ramp",
            ",", " ", 
           RowBox[{"LinearLayer", "[", "outputnodes", "]"}], ",", " ", 
           "LogisticSigmoid"}], "}"}], ",", " ", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "784"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"netinit", " ", "=", " ", 
       RowBox[{"NetInitialize", "[", 
        RowBox[{"mininet", ",", " ", 
         RowBox[{"Method", " ", "\[Rule]", 
          RowBox[{"{", "\"\<Xavier\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w0", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"w1", " ", "=", " ", 
       RowBox[{"Transpose", "@", 
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"netinit", ",", " ", 
           RowBox[{"{", 
            RowBox[{"All", ",", " ", "\"\<Weights\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"w0", " ", "=", " ", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0", ",", "0.1"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"inputdim", ",", " ", "hiddennodes"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"w1", " ", "=", " ", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0", ",", " ", "0.1"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"hiddennodes", ",", " ", "outputnodes"}], "}"}]}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"l2M", " ", "=", " ", "0"}], ";", " ", 
      RowBox[{"l1M", " ", "=", " ", "0"}], ";", " ", 
      RowBox[{"l2V", " ", "=", " ", "0"}], ";", " ", 
      RowBox[{"l1V", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"i", "\[LessEqual]", "iterations"}], ",", " ", 
          RowBox[{"i", "+=", "batchsize"}], ",", " ", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{
           RowBox[{"l0", " ", "=", " ", 
            RowBox[{"tx", "[", 
             RowBox[{"[", 
              RowBox[{"i", ";;", 
               RowBox[{"i", "+", "batchsize"}]}], "]"}], "]"}]}], ";", " ", 
           RowBox[{"l1", "=", " ", 
            RowBox[{"relu", "[", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"l0", ",", " ", "w0"}], "]"}], ",", " ", 
              RowBox[{"deriv", "=", "False"}]}], "]"}]}], ";", " ", 
           RowBox[{"l2", " ", "=", " ", 
            RowBox[{"sigmoid", "[", 
             RowBox[{
              RowBox[{"Dot", "[", 
               RowBox[{"l1", ",", " ", "w1"}], "]"}], ",", " ", 
              RowBox[{"deriv", "=", "False"}]}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"l2Error", " ", "=", " ", 
            RowBox[{"l2", " ", "-", " ", 
             RowBox[{"ty", "[", 
              RowBox[{"[", 
               RowBox[{"i", ";;", 
                RowBox[{"i", "+", "batchsize"}]}], "]"}], "]"}]}]}], ";", " ",
            "\[IndentingNewLine]", 
           RowBox[{"l2Delta", " ", "=", " ", 
            RowBox[{"l2Error", "*", 
             RowBox[{"sigmoid", "[", 
              RowBox[{"l2", ",", 
               RowBox[{"derive", "=", "True"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"l2Delta", " ", "=", " ", 
              RowBox[{"l2Error", "*", 
               RowBox[{"deltaCrossEntropy", "[", 
                RowBox[{"l2", ",", " ", 
                 RowBox[{"ty", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ";;", 
                    RowBox[{"i", "+", "batchsize"}]}], "]"}], "]"}]}], 
                "]"}]}]}], ";"}], "\t", "*)"}], 
           "                                    ", "\[IndentingNewLine]", 
           RowBox[{"l1Error", " ", "=", " ", 
            RowBox[{"Dot", "[", 
             RowBox[{"l2Delta", ",", " ", 
              RowBox[{"Transpose", "[", "w1", "]"}]}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"l1Delta", " ", "=", " ", 
            RowBox[{"l1Error", "*", 
             RowBox[{"relu", "[", 
              RowBox[{"l1", ",", " ", 
               RowBox[{"deriv", "=", "True"}]}], "]"}]}]}], ";", "  ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"WHAT", " ", "ARE", " ", "YOU", " ", "DOING"}], "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"g1", " ", "=", " ", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"l1", ",", " ", 
                   RowBox[{"2", "\[TwoWayRule]", " ", "3"}]}], "]"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"l2Delta", ",", " ", 
                    RowBox[{"{", "1", "}"}]}], "]"}], "/", "batchsize"}]}], 
                "]"}], ",", " ", 
               RowBox[{"{", "1", "}"}]}], "]"}], "/", "batchsize"}]}], ";", 
           "  ", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"WHAT", " ", "ARE", " ", "YOU", " ", "DOING"}], "*)"}], 
           "\[IndentingNewLine]", "         ", 
           RowBox[{"g0", " ", "=", " ", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"l0", ",", " ", 
                   RowBox[{"2", "\[TwoWayRule]", " ", "3"}]}], "]"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"l1Delta", ",", " ", 
                    RowBox[{"{", "1", "}"}]}], "]"}], "/", "batchsize"}]}], 
                "]"}], ",", " ", 
               RowBox[{"{", "1", "}"}]}], "]"}], "/", "batchsize"}]}], ";", 
           "  \t", "\[IndentingNewLine]", "\t", 
           RowBox[{"l2M", " ", "=", " ", 
            RowBox[{
             RowBox[{"l2M", "*", "b1"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "b1"}], ")"}], "*", "g1"}]}]}], ";", 
           RowBox[{"l1M", " ", "=", " ", 
            RowBox[{
             RowBox[{"l1M", "*", "b2"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "b2"}], ")"}], "*", "g0"}]}]}], ";", 
           "\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"l2V", " ", "=", " ", 
            RowBox[{
             RowBox[{"l2V", "*", "b2"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "b2"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"g1", "*", "g1"}], ")"}]}]}]}], ";", 
           "\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"l1V", " ", "=", " ", 
            RowBox[{
             RowBox[{"l1V", "*", "b1"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "b1"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"g0", "*", "g0"}], ")"}]}]}]}], ";", 
           "\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"l1MC", " ", "=", " ", 
            RowBox[{"l1M", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"b1", "^", "i"}]}], ")"}]}]}], ";", " ", 
           RowBox[{"l1VC", " ", "=", " ", 
            RowBox[{"l1V", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"b1", "^", "i"}]}], ")"}]}]}], ";", 
           "\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"l2MC", " ", "=", " ", 
            RowBox[{"l2M", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"b2", "^", "i"}]}], ")"}]}]}], ";", " ", 
           RowBox[{"l2VC", " ", "=", " ", 
            RowBox[{"l2V", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"b2", "^", "i"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"w1UDT", " ", "=", 
            RowBox[{"l2MC", "/", 
             RowBox[{"(", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"l2VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], 
           ";", "\t\t\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{"w0UDT", " ", "=", " ", 
            RowBox[{"l1MC", "/", 
             RowBox[{"(", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"l1VC", " ", "+", " ", "epsilon"}], "]"}], ")"}]}]}], 
           ";", "\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"w1", " ", "-=", " ", 
            RowBox[{"learningrate", "*", "w1UDT"}]}], ";", 
           "\t\t\t\t\t\t\t\t\t\t\t\t\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"w0", " ", "-=", " ", 
            RowBox[{"learningrate", "*", "w0UDT"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", " ", "1024"}], "]"}], 
              "\[Equal]", "0"}], ",", " ", 
             RowBox[{"Print", "[", 
              RowBox[{"MSE", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"runNet", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"w0", ",", " ", "w1"}], "}"}], ",", " ", 
                   RowBox[{"tx", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"ty", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";"}]}], "]"}], ",", " ", "epochs"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"w0", ",", " ", "w1"}], "}"}], "]"}], ";"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7391992612843556`*^9, 3.7391992719857254`*^9}, 
   3.739199370306464*^9, {3.7391995746087933`*^9, 3.739199575595129*^9}, {
   3.7392001834940405`*^9, 3.739200194466669*^9}, {3.7392005909049153`*^9, 
   3.739200601958338*^9}, {3.739201405660389*^9, 3.7392014136659718`*^9}, {
   3.739201783868734*^9, 3.739201784296587*^9}, {3.739203773130968*^9, 
   3.7392038160421667`*^9}, {3.7392040089744616`*^9, 3.739204026116598*^9}, {
   3.7392043189395103`*^9, 3.739204333925416*^9}, {3.739204394826993*^9, 
   3.739204397050045*^9}, 3.739207772330789*^9, {3.7392109798480663`*^9, 
   3.7392110202366242`*^9}, 3.7392110812804403`*^9, {3.739213100837415*^9, 
   3.7392131010079927`*^9}, {3.7392139633386917`*^9, 3.7392139794029427`*^9}, 
   3.7392142835780053`*^9, {3.7392143432569966`*^9, 3.739214409537236*^9}, {
   3.739214554444317*^9, 3.7392145827854257`*^9}, 3.739214675499508*^9, {
   3.739214825779476*^9, 3.7392148382236967`*^9}, {3.739215888237558*^9, 
   3.7392159366490183`*^9}, {3.739216309620159*^9, 3.7392163128186007`*^9}, {
   3.7392164310231056`*^9, 3.7392164647178164`*^9}, {3.7392166741203804`*^9, 
   3.7392167952817097`*^9}, {3.739217078226631*^9, 3.739217109006442*^9}, {
   3.739217248882512*^9, 3.7392172621653433`*^9}, {3.7392174457568502`*^9, 
   3.739217453223757*^9}, {3.739218328075309*^9, 3.7392183353300447`*^9}, {
   3.739218466638962*^9, 3.739218472036522*^9}, {3.7392193193826737`*^9, 
   3.7392193209680605`*^9}, {3.739219434932911*^9, 3.7392194656909533`*^9}, {
   3.7392198091631594`*^9, 3.739219813235222*^9}, {3.739219951491438*^9, 
   3.739219956514001*^9}, {3.739220413195808*^9, 3.7392204481463127`*^9}, {
   3.7392206661590223`*^9, 3.7392206802403584`*^9}, {3.739222067281087*^9, 
   3.73922212730726*^9}, {3.7392221893942657`*^9, 3.739222222274297*^9}, 
   3.7392224139773936`*^9, {3.739222581653812*^9, 3.739222594624098*^9}, {
   3.7392227797933645`*^9, 3.7392228142372255`*^9}, {3.7392229716785154`*^9, 
   3.7392229739813643`*^9}, {3.739223009778581*^9, 3.7392230115797615`*^9}, {
   3.739223559777153*^9, 3.739223564710943*^9}, {3.7392236906360555`*^9, 
   3.7392237176765137`*^9}, {3.739223902895378*^9, 3.7392239032663493`*^9}, {
   3.7392241914260902`*^9, 3.7392242242364073`*^9}, {3.7392250050317907`*^9, 
   3.739225015318241*^9}, 
   3.7392274689088135`*^9},ExpressionUUID->"0d246342-a2cf-4109-818d-\
b8fec17e025b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ElementwiseLayer", "[", "Sin", "]"}]], "Input",
 CellLabel->
  "In[143]:=",ExpressionUUID->"a5491fdb-85f1-4c33-9e5e-5063814edfc2"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["ElementwiseLayer", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = True}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"], 
                 ImageSizeCache -> {13., {0., 13.}}], Appearance -> None, 
                ButtonFunction :> (Typeset`open = True), Evaluator -> 
                Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014705882352941176`], {
                 RGBColor[0.33, 0.33, 0.33], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 18.5}, {14., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.557, 0.557, 0.557], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{52.5, 18.5}, {44., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.85, 0.85, 0.85], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{22.23,
                   18.5}, {33.5, 29.77}, {44.77, 18.5}, {33.5, 7.23}}}]}, {
                 FaceForm[{
                   RGBColor[0.56, 0.56, 0.56], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{33.5, 30.29}, {21.71, 
                  18.5}, {33.5, 6.71}, {45.29, 18.5}}, {{33.5, 29.25}, {44.25,
                   18.5}, {33.5, 7.75}, {22.75, 18.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{53.56, 15.4}, {51.88, 15.4}, {50.52, 16.76}, {
                  50.52, 18.44}, {50.52, 20.12}, {51.88, 21.48}, {53.56, 
                  21.48}, {55.24, 21.48}, {56.6, 20.12}, {56.6, 18.44}, {56.6,
                   16.76}, {55.24, 15.4}, {53.56, 15.4}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {0, 1, 0}}}, {{{53.56, 21.83}, {51.69, 21.83}, {50.17, 
                   20.31}, {50.17, 18.44}, {50.17, 16.57}, {51.69, 15.05}, {
                   53.56, 15.05}, {55.43, 15.05}, {56.95, 16.57}, {56.95, 
                   18.44}, {56.95, 20.31}, {55.43, 21.83}, {53.56, 21.83}}, {{
                   53.56, 21.83}, {53.56, 21.13}, {55.04, 21.13}, {56.25, 
                   19.92}, {56.25, 18.44}, {56.25, 16.96}, {55.04, 15.75}, {
                   53.56, 15.75}, {52.08, 15.75}, {50.87, 16.96}, {50.87, 
                   18.44}, {50.87, 19.92}, {52.08, 21.13}, {53.56, 21.13}, {
                   53.56, 21.83}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{13.56, 15.5}, {11.94, 15.5}, {10.62, 16.82}, {
                  10.62, 18.44}, {10.62, 20.06}, {11.94, 21.38}, {13.56, 
                  21.38}, {15.18, 21.38}, {16.5, 20.06}, {16.5, 18.44}, {16.5,
                   16.82}, {15.18, 15.5}, {13.56, 15.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {1, 3, 3}}}, {{{13.56, 21.73}, {11.74, 21.73}, {10.27, 
                   20.26}, {10.27, 18.44}, {10.27, 16.62}, {11.74, 15.15}, {
                   13.56, 15.15}, {15.38, 15.15}, {16.85, 16.62}, {16.85, 
                   18.44}, {16.85, 20.26}, {15.38, 21.73}, {13.56, 
                   21.73}}, CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd/6OnCHnLaDx8MqkXXspg4MINCgA+efPQMCug6H
v2rE9B8ygYgf13MAa3M1gYrrQ8WNHdJAQM3AAcR1V0TwC225ri8uMILzwfqY
DB2qgcoe/tJ1MAaBzfoOMPfA+GBtezXhfIg5GlB1Bg7fQNaXqjsAya8acwwg
5lWpOcyaCQSShhD1H1Qh/jqA4MPcA+ODzbtnDHGXkwbc/+jhAwASgHiO
                   "]}]}}, ImageSize -> {40, Automatic}], 
              GridBox[{{
                 StyleBox[
                  TemplateBox[{"\"Function\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  PaneBox[
                  "Sin", BaseStyle -> {
                    IndentMaxFraction -> 0.1, ShowStringCharacters -> True}, 
                   ImageSize -> {250}], "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Output\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"tensor\"", "SummaryItem"]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            BaselinePosition -> {1, 3}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridBoxSpacings -> {"Columns" -> {
                Offset[0.], {
                 Offset[0.5599999999999999]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.], {
                 Offset[0.4]}, 
                Offset[0.]}, "RowsIndexed" -> {}}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"], 
                 ImageSizeCache -> {13., {0., 13.}}], Appearance -> None, 
                ButtonFunction :> (Typeset`open = False), Evaluator -> 
                Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              GraphicsBox[{
                Thickness[0.014705882352941176`], {
                 RGBColor[0.33, 0.33, 0.33], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 18.5}, {14., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 RGBColor[0.557, 0.557, 0.557], 
                 Thickness[0.015029411764705883`], 
                 Opacity[1.], 
                 JoinForm[{"Miter", 10.}], 
                 
                 JoinedCurveBox[{{{0, 2, 0}}}, {{{52.5, 18.5}, {44., 18.5}}}, 
                  CurveClosed -> {0}]}, {
                 FaceForm[{
                   RGBColor[0.85, 0.85, 0.85], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{22.23,
                   18.5}, {33.5, 29.77}, {44.77, 18.5}, {33.5, 7.23}}}]}, {
                 FaceForm[{
                   RGBColor[0.56, 0.56, 0.56], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                  0}, {0, 1, 0}, {0, 1, 0}}}, {{{33.5, 30.29}, {21.71, 
                  18.5}, {33.5, 6.71}, {45.29, 18.5}}, {{33.5, 29.25}, {44.25,
                   18.5}, {33.5, 7.75}, {22.75, 18.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{53.56, 15.4}, {51.88, 15.4}, {50.52, 16.76}, {
                  50.52, 18.44}, {50.52, 20.12}, {51.88, 21.48}, {53.56, 
                  21.48}, {55.24, 21.48}, {56.6, 20.12}, {56.6, 18.44}, {56.6,
                   16.76}, {55.24, 15.4}, {53.56, 15.4}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {0, 1, 0}}}, {{{53.56, 21.83}, {51.69, 21.83}, {50.17, 
                   20.31}, {50.17, 18.44}, {50.17, 16.57}, {51.69, 15.05}, {
                   53.56, 15.05}, {55.43, 15.05}, {56.95, 16.57}, {56.95, 
                   18.44}, {56.95, 20.31}, {55.43, 21.83}, {53.56, 21.83}}, {{
                   53.56, 21.83}, {53.56, 21.13}, {55.04, 21.13}, {56.25, 
                   19.92}, {56.25, 18.44}, {56.25, 16.96}, {55.04, 15.75}, {
                   53.56, 15.75}, {52.08, 15.75}, {50.87, 16.96}, {50.87, 
                   18.44}, {50.87, 19.92}, {52.08, 21.13}, {53.56, 21.13}, {
                   53.56, 21.83}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                  3}}}, {{{13.56, 15.5}, {11.94, 15.5}, {10.62, 16.82}, {
                  10.62, 18.44}, {10.62, 20.06}, {11.94, 21.38}, {13.56, 
                  21.38}, {15.18, 21.38}, {16.5, 20.06}, {16.5, 18.44}, {16.5,
                   16.82}, {15.18, 15.5}, {13.56, 15.5}}}]}, {
                 FaceForm[{
                   RGBColor[
                   0.43900000000000006`, 0.43900000000000006`, 
                    0.43900000000000006`], 
                   Opacity[1.]}], 
                 
                 FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                   3}, {1, 3, 3}}}, {{{13.56, 21.73}, {11.74, 21.73}, {10.27, 
                   20.26}, {10.27, 18.44}, {10.27, 16.62}, {11.74, 15.15}, {
                   13.56, 15.15}, {15.38, 15.15}, {16.85, 16.62}, {16.85, 
                   18.44}, {16.85, 20.26}, {15.38, 21.73}, {13.56, 
                   21.73}}, CompressedData["
1:eJxTTMoPSmViYGAQBmIQLd/6OnCHnLaDx8MqkXXspg4MINCgA+efPQMCug6H
v2rE9B8ygYgf13MAa3M1gYrrQ8WNHdJAQM3AAcR1V0TwC225ri8uMILzwfqY
DB2qgcoe/tJ1MAaBzfoOMPfA+GBtezXhfIg5GlB1Bg7fQNaXqjsAya8acwwg
5lWpOcyaCQSShhD1H1Qh/jqA4MPcA+ODzbtnDHGXkwbc/+jhAwASgHiO
                   "]}]}}, ImageSize -> {40, Automatic}], 
              GridBox[{{
                 ItemBox[
                  StyleBox["Parameters", FontWeight -> Bold]], 
                 ItemBox[""]}, {
                 StyleBox[
                  TemplateBox[{"\"Function\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  PaneBox[
                  "Sin", BaseStyle -> {
                    IndentMaxFraction -> 0.1, ShowStringCharacters -> True}, 
                   ImageSize -> {250}], "SummaryItem"]}, {
                 ItemBox[
                  StyleBox["Ports", FontWeight -> Bold], 
                  Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                  GrayLevel[0.85]], 
                 ItemBox[
                  StyleBox[
                   
                   GraphicsBox[{}, 
                    BaselinePosition -> (Scaled[0.] -> Baseline), 
                    ImageSize -> {1, 11}], CacheGraphics -> False], 
                  Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                  GrayLevel[0.85]]}, {
                 StyleBox[
                  TemplateBox[{"\"Input\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"tensor\"", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{"\"Output\"", "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox["\"tensor\"", "SummaryItem"]}}, 
               BaselinePosition -> {2, 1}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            BaselinePosition -> {1, 3}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridBoxSpacings -> {"Columns" -> {
                Offset[0.], {
                 Offset[0.5599999999999999]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.], {
                 Offset[0.4]}, 
                Offset[0.]}, "RowsIndexed" -> {}}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}, BaselinePosition -> Baseline]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("ElementwiseLayer[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.7392275431601095`*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"b843d76f-b80f-4e7e-97dd-0bfd574a49ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ElementwiseLayer", "[", "Sin", "]"}], "[", 
  RowBox[{"1", ",", " ", 
   RowBox[{"NetPortGradient", "[", "\"\<Input\>\"", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7392274743606634`*^9, 3.7392275271589003`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"5382b3bb-3775-417d-b5f2-4815e55fa45f"],

Cell[BoxData["0.5403022766113281`"], "Output",
 CellChangeTimes->{3.739227494136249*^9, 3.7392275301877966`*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"b5e76e62-d1d9-4a65-99da-7a6021f357e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"z", " ", "=", " ", 
   RowBox[{"buildNet", "[", 
    RowBox[{
    "tx", ",", " ", "ty", ",", " ", "b1", ",", " ", "b2", ",", " ", 
     "epsilon"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7391842745948677`*^9, 3.7391842776082344`*^9}, {
   3.73918458194786*^9, 3.739184583395079*^9}, {3.7391846795089464`*^9, 
   3.7391846828237514`*^9}, {3.739198483283041*^9, 3.7391984911051435`*^9}, 
   3.7391993751494813`*^9, 3.73922345321619*^9, {3.7392235739741774`*^9, 
   3.739223574618435*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"ef5ab3a2-1643-45ed-959d-84f47e0c95c2"],

Cell[CellGroupData[{

Cell[BoxData["0.1375249471052623`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.7392250772794704`*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"0439d45d-1dd1-4d3a-97f2-677c85588059"],

Cell[BoxData["0.0999984770962872`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.7392250813186626`*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"cd30c255-42b7-40c5-9779-df6a7f8cc513"],

Cell[BoxData["0.1000000000000075`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.7392250846926346`*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"2e0a1c06-8c6f-460a-bdb8-6d30e347be14"],

Cell[BoxData["0.1`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.739225088677973*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"c6718e59-4e35-44fd-a951-5f92d6d79f3e"],

Cell[BoxData["0.1`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.739225092080868*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"191a2e37-a45a-454e-9509-2f364d06a506"],

Cell[BoxData["0.1`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.7392250960582266`*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"e1e86630-6717-4944-821b-177e5bf27de7"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"4.074221007669749`*^-188\\\", \\\" \\\", \
\\\"4.074221007669749`*^-188\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,138,20,
   30264771395981210622,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73922509999271*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"5fb3cb7d-f0a2-4a70-baf9-fe01517a7acf"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"1.0915348527768157`*^-154\\\", \\\" \\\", \
\\\"1.0915348527768157`*^-154\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,138,21,
   30264771395981210622,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.739225101310177*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"11cb082f-3cb0-4533-839c-5247a6b4de22"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"1.4682141488596124`*^-283\\\", \\\" \\\", \
\\\"1.4682141488596124`*^-283\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,138,22,
   30264771395981210622,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7392251026476*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"59d9ed5d-00f6-4c40-8bd3-28c2fda50a0d"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,138,23,30264771395981210622,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.739225103728705*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"d04c188e-ec1e-49fb-9e54-61b98526f35c"],

Cell[CellGroupData[{

Cell[BoxData["0.1`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.739225104717061*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"cbc61e2f-d88c-4aa4-a8bf-5c0d726948bd"],

Cell[BoxData["0.1`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.739225108798142*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"008cd758-afb4-47be-a71d-cca4dbf2c00b"],

Cell[BoxData["0.1`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.739225112215*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"4b641944-9472-4786-932f-a423841beb7e"],

Cell[BoxData["0.1`"], "Print",
 CellChangeTimes->{3.739223990235467*^9, 3.739224148618928*^9, 
  3.7392242388580537`*^9, 3.7392250350943327`*^9, 3.7392251162262697`*^9},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"762932a0-ada6-4c97-ae32-adcd011c8a44"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runNet", "[", 
  RowBox[{"z", ",", " ", 
   RowBox[{"tx", "[", 
    RowBox[{"[", "42421", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.739219653696536*^9, 3.739219660863119*^9}, {
   3.7392197027101164`*^9, 3.7392197697206182`*^9}, {3.7392198794692435`*^9, 
   3.739219881290923*^9}, {3.739220069843794*^9, 3.7392200715582075`*^9}, 
   3.739220632322547*^9, {3.739223415475165*^9, 3.7392234199272532`*^9}, {
   3.739223543429902*^9, 3.739223545565178*^9}, {3.739224069035647*^9, 
   3.7392240710402775`*^9}, {3.7392250534911256`*^9, 3.7392250602420516`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"aaa3dec1-28dc-4d1d-8085-2ad31190d2ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
   "1.2174131779310209`*^-273", ",", "1.6808650832923006`*^-223", ",", 
    "9.6780977024309803130924075518001955597447`12.98813267712693*^-403", ",",
     "5.939608370032003`*^-222", ",", "1.4716120915754192`*^-208", ",", 
    "4.1508520168751077`*^-246", ",", "3.1400650001493697`*^-143", ",", 
    "1.386141459821931`*^-92", ",", "1.3629280257358528`*^-211", ",", 
    "1.2514835204788116`*^-179"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7392197271814065`*^9, 3.7392197700228157`*^9}, {
   3.7392198764096556`*^9, 3.739219881622035*^9}, {3.73922006303102*^9, 
   3.7392200721117277`*^9}, {3.739220625916686*^9, 3.739220632869088*^9}, 
   3.7392211246724625`*^9, {3.7392234058209925`*^9, 3.7392234202314377`*^9}, {
   3.7392235358770857`*^9, 3.739223546118684*^9}, {3.7392240661792836`*^9, 
   3.739224071344464*^9}, 3.73922499907869*^9, {3.7392250490230665`*^9, 
   3.739225060804547*^9}, 3.7392273720743127`*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"9e772a9b-4b64-406e-aed4-64956e383eb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ty", "[", 
  RowBox[{"[", "42421", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7392197341690483`*^9, 3.7392197796269417`*^9}, {
  3.739223540467812*^9, 3.7392235406004477`*^9}, {3.739227381675601*^9, 
  3.7392273822301197`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"4bdc6864-3bc3-4b71-b0c9-2f7940eee5cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
   "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
    ",", "0", ",", "0"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7392197373078203`*^9, 3.739219779831328*^9}, 
   3.7392235411240463`*^9, 3.739227382825523*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"d7c564aa-b596-41f8-b2e8-46a4a30010db"]
}, Open  ]]
},
WindowSize->{990, 1028},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 7, 2018)",
StyleDefinitions->"ReverseColor.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 3327, 71, 121, "Input",ExpressionUUID->"9ef69ac0-10de-4ab5-b332-39bce14ea535"],
Cell[3891, 93, 1668, 35, 209, "Input",ExpressionUUID->"e1a2b6d6-7ce8-4675-bec5-747d5309d469"],
Cell[5562, 130, 5455, 144, 385, "Input",ExpressionUUID->"a3942673-5bd5-4f48-b4fc-55dea3b9de20"],
Cell[11020, 276, 895, 23, 32, "Input",ExpressionUUID->"44e5af52-d1a2-46ee-82a9-0363e6f9e79e"],
Cell[11918, 301, 14151, 307, 825, "Input",ExpressionUUID->"0d246342-a2cf-4109-818d-b8fec17e025b"],
Cell[CellGroupData[{
Cell[26094, 612, 154, 3, 32, "Input",ExpressionUUID->"a5491fdb-85f1-4c33-9e5e-5063814edfc2"],
Cell[26251, 617, 14857, 296, 138, "Output",ExpressionUUID->"b843d76f-b80f-4e7e-97dd-0bfd574a49ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41145, 918, 335, 7, 32, "Input",ExpressionUUID->"5382b3bb-3775-417d-b5f2-4815e55fa45f"],
Cell[41483, 927, 195, 3, 36, "Output",ExpressionUUID->"b5e76e62-d1d9-4a65-99da-7a6021f357e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41715, 935, 614, 13, 32, "Input",ExpressionUUID->"ef5ab3a2-1643-45ed-959d-84f47e0c95c2"],
Cell[CellGroupData[{
Cell[42354, 952, 290, 5, 23, "Print",ExpressionUUID->"0439d45d-1dd1-4d3a-97f2-677c85588059"],
Cell[42647, 959, 290, 5, 23, "Print",ExpressionUUID->"cd30c255-42b7-40c5-9779-df6a7f8cc513"],
Cell[42940, 966, 290, 5, 23, "Print",ExpressionUUID->"2e0a1c06-8c6f-460a-bdb8-6d30e347be14"],
Cell[43233, 973, 273, 5, 23, "Print",ExpressionUUID->"c6718e59-4e35-44fd-a951-5f92d6d79f3e"],
Cell[43509, 980, 273, 5, 23, "Print",ExpressionUUID->"191a2e37-a45a-454e-9509-2f364d06a506"],
Cell[43785, 987, 275, 5, 23, "Print",ExpressionUUID->"e1e86630-6717-4944-821b-177e5bf27de7"]
}, Open  ]],
Cell[44075, 995, 475, 11, 25, "Message",ExpressionUUID->"5fb3cb7d-f0a2-4a70-baf9-fe01517a7acf"],
Cell[44553, 1008, 478, 11, 25, "Message",ExpressionUUID->"11cb082f-3cb0-4533-839c-5247a6b4de22"],
Cell[45034, 1021, 476, 11, 25, "Message",ExpressionUUID->"59d9ed5d-00f6-4c40-8bd3-28c2fda50a0d"],
Cell[45513, 1034, 448, 10, 23, "Message",ExpressionUUID->"d04c188e-ec1e-49fb-9e54-61b98526f35c"],
Cell[CellGroupData[{
Cell[45986, 1048, 273, 5, 23, "Print",ExpressionUUID->"cbc61e2f-d88c-4aa4-a8bf-5c0d726948bd"],
Cell[46262, 1055, 273, 5, 23, "Print",ExpressionUUID->"008cd758-afb4-47be-a71d-cca4dbf2c00b"],
Cell[46538, 1062, 270, 5, 23, "Print",ExpressionUUID->"4b641944-9472-4786-932f-a423841beb7e"],
Cell[46811, 1069, 275, 5, 23, "Print",ExpressionUUID->"762932a0-ada6-4c97-ae32-adcd011c8a44"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47135, 1080, 675, 12, 32, "Input",ExpressionUUID->"aaa3dec1-28dc-4d1d-8085-2ad31190d2ca"],
Cell[47813, 1094, 1065, 18, 69, "Output",ExpressionUUID->"9e772a9b-4b64-406e-aed4-64956e383eb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48915, 1117, 337, 7, 32, "Input",ExpressionUUID->"4bdc6864-3bc3-4b71-b0c9-2f7940eee5cb"],
Cell[49255, 1126, 387, 9, 36, "Output",ExpressionUUID->"d7c564aa-b596-41f8-b2e8-46a4a30010db"]
}, Open  ]]
}
]
*)

