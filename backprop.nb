(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32514,        848]
NotebookOptionsPosition[     28471,        782]
NotebookOutlinePosition[     28813,        797]
CellTagsIndexPosition[     28770,        794]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"net", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"<|", 
     RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Softmax\>\""}], "|>"}], ",", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
      RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
       RowBox[{"<|", 
        RowBox[{"\"\<Weights\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5", ",", "6"}], "}"}]}], "|>"}]}]}], "|>"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.739229842962337*^9, 3.739229924041678*^9}, {
  3.7392302487097397`*^9, 3.739230273979878*^9}, {3.739230452943368*^9, 
  3.7392304620214853`*^9}, {3.739234283963745*^9, 3.7392342843447123`*^9}, {
  3.739234522442684*^9, 
  3.7392345241092234`*^9}},ExpressionUUID->"ed9aac8d-2a98-4de2-8077-\
50d136f16962"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"Softmax\"\>"}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"LayerType\"\>", "\[Rule]", "\<\"LinearLayer\"\>"}], ",", 
     RowBox[{"\<\"Parameters\"\>", "\[Rule]", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{"\<\"Weights\"\>", "\[Rule]", 
        RowBox[{"{", "}"}]}], "\[RightAssociation]"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739230254967615*^9, 3.739230274721499*^9}, 
   3.7392343001194954`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"97db5fd5-a5f1-4331-b506-4986a2073679"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"netEval", "[", 
   RowBox[{"net", ",", "x"}], "]"}], "\[Rule]", "output"}]], "Input",
 CellChangeTimes->{{3.739229942624263*^9, 3.7392299443947372`*^9}, {
  3.739229975211225*^9, 
  3.739229990963319*^9}},ExpressionUUID->"2dbf051b-6794-4698-8118-\
162650303536"],

Cell[BoxData[
 RowBox[{
  RowBox[{"layerEval", "[", 
   RowBox[{"x_", ",", "layer_Association"}], "]"}], ":=", 
  RowBox[{"layerEval", "[", 
   RowBox[{"x", ",", 
    RowBox[{"Lookup", "[", 
     RowBox[{"layer", ",", "\"\<LayerType\>\""}], "]"}], ",", 
    RowBox[{"Lookup", "[", 
     RowBox[{"layer", ",", "\"\<Parameters\>\""}], "]"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.739230048096012*^9, 3.739230126331902*^9}, {
  3.7392303998589163`*^9, 3.7392304087510443`*^9}, {3.739233146376992*^9, 
  3.739233146687701*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"d57d0057-fe9a-4da0-9f04-120c71ce74a7"],

Cell["Layer Definitions", "Item",
 CellChangeTimes->{{3.739230512517234*^9, 
  3.739230517821245*^9}},ExpressionUUID->"b56e90d2-1c5d-4473-8b05-\
17413a12a660"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", "\"\<Softmax\>\"", ",", "_"}], "]"}], ":=", " ", 
   RowBox[{"2", "*", "x"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739230137133313*^9, 3.7392301547717657`*^9}, {
  3.739230239695559*^9, 3.7392302423574457`*^9}, {3.7392304265585127`*^9, 
  3.739230429391158*^9}, {3.739235853406686*^9, 3.7392358643408203`*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"acb2f457-f421-42d4-8830-3e4963faaf61"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", "\"\<Ramp\>\"", ",", "_"}], "]"}], ":=", 
   RowBox[{"3", "*", "x"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739230431911519*^9, 3.739230434709384*^9}, {
  3.7392358604536695`*^9, 3.739235862620289*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"abdfd562-ad5d-4eb0-951c-8eafa6924402"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", "\"\<LinearLayer\>\"", ",", "param_"}], "]"}], ":=", 
   RowBox[{"Dot", "[", 
    RowBox[{"x", ",", 
     RowBox[{"param", "[", "\"\<Weights\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.739230437967194*^9, 3.7392304954295473`*^9}, {
  3.7392358664325333`*^9, 3.739235870166593*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"20ace5f3-c91b-4613-89ef-827d827ac0d1"],

Cell["Evaluator", "Item",
 CellChangeTimes->{{3.73923052312189*^9, 
  3.739230525132897*^9}},ExpressionUUID->"e9160ad1-42b4-4836-8a14-\
2a7090eabea3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"netEvaluate", "[", 
   RowBox[{"net_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"layerEval", ",", "x", ",", "net"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"netEvaluate", "[", 
   RowBox[{"net_", ",", "x_", ",", "\"\<Training\>\""}], "]"}], ":=", 
  RowBox[{"FoldList", "[", 
   RowBox[{"layerEval", ",", "x", ",", "net"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.739230175331674*^9, 3.739230235753093*^9}, {
  3.739230370543332*^9, 3.739230380413294*^9}, {3.739231018286749*^9, 
  3.739231046925303*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"0d14c289-5af1-4794-b1e4-8127b6b829cf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"netEvaluate", "[", 
  RowBox[{"net", ",", " ", 
   RowBox[{"{", "2", "}"}], ",", " ", "\"\<Training\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.739235825122863*^9, 3.739235842480259*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"6e78d7f6-b2f0-49ce-8353-83c9882d5a3f"],

Cell[BoxData[
 TemplateBox[{
  "Dot","dotsh",
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", \\\"4\\\", \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) have incompatible shapes.\"",2,175,
   25,30264771395981210622,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7392358946375914`*^9},
 CellLabel->
  "During evaluation of \
In[175]:=",ExpressionUUID->"cbc04d72-bb45-4b63-83c7-4257479189b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{
    RowBox[{"{", "4", "}"}], ".", 
    RowBox[{"{", "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7392358432083707`*^9, {3.73923587482167*^9, 3.7392358946415873`*^9}},
 CellLabel->
  "Out[175]=",ExpressionUUID->"d959b0c6-422d-475c-9477-cbb1ce6fa7dd"]
}, Open  ]],

Cell["Backpass", "Item",
 CellChangeTimes->{{3.73923052312189*^9, 
  3.7392305371255703`*^9}},ExpressionUUID->"cfbb2f93-258d-4f8c-b0db-\
bb3f6a7d31fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"netD", "[", 
   RowBox[{"x_", ",", "y_", ",", "net_", ",", "loss_"}], "]"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"<|", 
     RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Softmax\>\""}], "|>"}], ",", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
      RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Weights\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", ".."}], "|>"}]}]}], "|>"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.739230545228664*^9, 3.739230573189672*^9}, {
   3.739230608088087*^9, 3.739230614552938*^9}, 
   3.739230668051812*^9},ExpressionUUID->"2d8380fd-307a-4dee-9876-\
a4e01f596aad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{"updater", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", "l2", ",", "l3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"g1", ",", "g2", ",", "g3"}], "}"}]}], "}"}]}], "]"}], 
  "\[Rule]", " ", 
  RowBox[{"new", " ", "net"}]}]], "Input",
 CellChangeTimes->{{3.739230707317945*^9, 
  3.739230767316691*^9}},ExpressionUUID->"8f97cd7e-a668-416a-8e15-\
c8b38fa1f560"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "4"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "6"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.739230719596405*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"dfbb809c-17d6-4b07-8014-c45184426ac3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<Input\>\"", "\[Rule]", "..."}], ",", 
    RowBox[{"\"\<Target\>\"", "\[Rule]", "..."}]}], "|>"}]}]], "Input",
 CellChangeTimes->{{3.7392306216237593`*^9, 
  3.739230629745125*^9}},ExpressionUUID->"cb221f5c-69a2-4b75-b7c8-\
93dd136b9e11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"net", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w0"}], "|>"}]}]}], "|>"}], 
     ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Ramp\>\""}], "|>"}], ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<LinearLayer\>\""}], ",", 
       RowBox[{"\"\<Parameters\>\"", "\[Rule]", 
        RowBox[{"<|", 
         RowBox[{"\"\<Weights\>\"", "\[Rule]", "w1"}], "|>"}]}]}], "|>"}], 
     ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<LayerType\>\"", "\[Rule]", "\"\<Sigmoid\>\""}], "|>"}]}], 
    "}"}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"25d958e1-0696-4199-8c75-01de0bcd3f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"layerEval", "[", 
   RowBox[{"x_", ",", " ", "layer_Association"}], "]"}], ":=", 
  RowBox[{"layerEval", "[", 
   RowBox[{"x", ",", " ", 
    RowBox[{"Lookup", "[", 
     RowBox[{"layer", ",", " ", "\"\<LayerType\>\""}], "]"}], ",", " ", 
    RowBox[{"Lookup", "[", 
     RowBox[{"layer", ",", "\"\<Parameters\>\""}], "]"}]}], "]"}]}]], "Input",\

 CellLabel->"In[2]:=",ExpressionUUID->"3cfd9ca1-86ba-4b52-9a75-08d99d0372d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Sigmoid\>\""}], "]"}], ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", "x"}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", 
    RowBox[{"x_", ",", " ", "\"\<Ramp\>\""}], "]"}], " ", ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], "*", 
     RowBox[{"UnitStep", "[", "x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layerEval", "[", " ", 
    RowBox[{"x_", ",", " ", "\"\<LinearLayer\>\"", ",", " ", "param_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Return", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"x", ",", " ", 
      RowBox[{"param", "[", "\"\<Weights\>\"", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"netEvaluate", "[", 
   RowBox[{"net_", ",", " ", "x_", ",", " ", "\"\<Training\>\""}], "]"}], " ",
   ":=", " ", 
  RowBox[{"FoldList", "[", 
   RowBox[{"layerEval", ",", " ", "x", ",", " ", "net"}], "]"}]}]}], "Input",
 CellChangeTimes->{3.7392378705238304`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"52653755-6bb6-4a13-8848-ebe5507ef5c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"netEvaluate", "[", 
  RowBox[{"net", ",", " ", "x", ",", " ", "\"\<Training\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.739238038782663*^9, 3.7392380395685616`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"88f19372-da0f-4b0e-baf3-21c005bac762"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", 
   RowBox[{"x", ".", "w0"}], ",", 
   RowBox[{"layerEval", "[", 
    RowBox[{
     RowBox[{"x", ".", "w0"}], ",", "\<\"Ramp\"\>", ",", 
     RowBox[{"Missing", "[", 
      RowBox[{"\<\"KeyAbsent\"\>", ",", "\<\"Parameters\"\>"}], "]"}]}], 
    "]"}], ",", 
   RowBox[{
    RowBox[{"layerEval", "[", 
     RowBox[{
      RowBox[{"x", ".", "w0"}], ",", "\<\"Ramp\"\>", ",", 
      RowBox[{"Missing", "[", 
       RowBox[{"\<\"KeyAbsent\"\>", ",", "\<\"Parameters\"\>"}], "]"}]}], 
     "]"}], ".", "w1"}], ",", 
   RowBox[{"layerEval", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"layerEval", "[", 
       RowBox[{
        RowBox[{"x", ".", "w0"}], ",", "\<\"Ramp\"\>", ",", 
        RowBox[{"Missing", "[", 
         RowBox[{"\<\"KeyAbsent\"\>", ",", "\<\"Parameters\"\>"}], "]"}]}], 
       "]"}], ".", "w1"}], ",", "\<\"Sigmoid\"\>", ",", 
     RowBox[{"Missing", "[", 
      RowBox[{"\<\"KeyAbsent\"\>", ",", "\<\"Parameters\"\>"}], "]"}]}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7392380399974136`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"c3c87551-5e35-4c71-9515-5ba942e939b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "@", 
  RowBox[{"netEvaluate", "[", 
   RowBox[{"net", ",", " ", "x", ",", " ", "\"\<Training\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7392378738160224`*^9, 3.7392378831011887`*^9}, {
  3.739238031874146*^9, 3.7392380326400986`*^9}, {3.7392383559852724`*^9, 
  3.7392383594240513`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"2c5943db-387a-43e2-88ee-461d934a61bc"],

Cell[BoxData[
 RowBox[{"{", "5", "}"}]], "Output",
 CellChangeTimes->{3.7392379530201187`*^9, 3.739238032972209*^9, 
  3.739238359530768*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"998c4393-f30a-4212-9970-10b1da61a6fa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"training", " ", "=", " ", 
   RowBox[{"RandomSample", "[", 
    RowBox[{"ExampleData", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<MachineLearning\>\"", ",", "\"\<MNIST\>\""}], "}"}], ",", 
      "\"\<TrainingData\>\""}], "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"0455c996-f8c8-4893-a607-bb8e2c5ca565"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tx", " ", "=", " ", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"ImageData", ",", " ", 
       RowBox[{"training", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"60000", ",", " ", "784"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7392385013311567`*^9, 3.7392385016622663`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"36a3c81d-c1e1-42e5-be40-a439de3b31c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "@", "tx"}]], "Input",
 CellChangeTimes->{{3.7392385495920324`*^9, 3.739238551454048*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"309c1011-41ef-4f60-bcdf-327c677dd8b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"60000", ",", "784"}], "}"}]], "Output",
 CellChangeTimes->{3.739238551961691*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"9ced27a7-4ebb-42d9-9dd7-af14217a845a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tt", "  ", "=", " ", 
   RowBox[{"training", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ty", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"60000", ",", " ", "10"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"d2039697-8ec7-4bf7-8098-6b80b442002e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
     RowBox[{"i", "\[LessEqual]", "60000"}], ",", " ", 
     RowBox[{"i", "++"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"ty", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"1", "+", 
           RowBox[{"tt", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", " ", 
       "1"}], ";"}]}], "]"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.7392385666174927`*^9, 
  3.7392385728094883`*^9}},ExpressionUUID->"d3e07553-3583-4f8a-ada6-\
203ccf61bd97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"training", " ", "=", " ", 
   RowBox[{"RandomSample", "[", 
    RowBox[{"ExampleData", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<MachineLearning\>\"", ",", "\"\<MNIST\>\""}], "}"}], ",", 
      "\"\<TrainingData\>\""}], "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"d8787ba7-b85c-4184-a279-8dcda3ca5db4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"training", "[", 
  RowBox[{"[", 
   RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7392396542846575`*^9, 3.7392397145641775`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"66931c41-ea79-40d5-83f1-810e8b2d543c"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
          "2", ",", "9", ",", "0", ",", "1", ",", "5", ",", "5", ",", "3", 
           ",", "8", ",", "6", ",", "0", ",", "5", ",", "8", ",", "0", ",", 
           "3", ",", "3", ",", "1", ",", "2", ",", "3", ",", "7", ",", "1", 
           ",", "2", ",", "3", ",", "3", ",", "0", ",", "0", ",", "3", ",", 
           "8", ",", "3", ",", "6", ",", "4", ",", "3", ",", "3", ",", "6", 
           ",", "8", ",", "4", ",", "9", ",", "2", ",", "1", ",", "5", ",", 
           "8", ",", "5", ",", "5", ",", "1", ",", "4", ",", "9", ",", "6", 
           ",", "1", ",", "1", ",", "3", ",", "3", ",", "2", ",", "9", ",", 
           "9", ",", "0", ",", "4", ",", "3", ",", "6", ",", "0", ",", "5", 
           ",", "2", ",", "8", ",", "7", ",", "8", ",", "8", ",", "3", ",", 
           "3", ",", "6", ",", "2", ",", "6", ",", "2", ",", "0", ",", "6", 
           ",", "6", ",", "0", ",", "6", ",", "3", ",", "0", ",", "2", ",", 
           "3", ",", "4", ",", "0", ",", "0", ",", "0", ",", "6", ",", "6", 
           ",", "9", ",", "3", ",", "5", ",", "1", ",", "0", ",", "2", ",", 
           "5", ",", "1", ",", "0", ",", "7", ",", "5", ",", "2", ",", "1", 
           ",", "2", ",", "1", ",", "6", ",", "4", ",", "1", ",", "8", ",", 
           "9", ",", "3", ",", "8", ",", "3", ",", "5", ",", 
           TemplateBox[{"59783"},
            "OutputSizeLimit`Skeleton"], ",", "9", ",", "9", ",", "4", ",", 
           "8", ",", "4", ",", "5", ",", "0", ",", "1", ",", "5", ",", "7", 
           ",", "3", ",", "7", ",", "2", ",", "9", ",", "7", ",", "4", ",", 
           "3", ",", "3", ",", "7", ",", "6", ",", "1", ",", "8", ",", "8", 
           ",", "9", ",", "1", ",", "1", ",", "8", ",", "2", ",", "6", ",", 
           "1", ",", "9", ",", "2", ",", "2", ",", "8", ",", "9", ",", "3", 
           ",", "6", ",", "4", ",", "5", ",", "3", ",", "3", ",", "1", ",", 
           "7", ",", "1", ",", "9", ",", "2", ",", "8", ",", "2", ",", "2", 
           ",", "8", ",", "6", ",", "6", ",", "2", ",", "7", ",", "6", ",", 
           "8", ",", "3", ",", "5", ",", "3", ",", "7", ",", "3", ",", "6", 
           ",", "0", ",", "4", ",", "7", ",", "6", ",", "8", ",", "7", ",", 
           "8", ",", "8", ",", "4", ",", "8", ",", "9", ",", "8", ",", "4", 
           ",", "4", ",", "6", ",", "8", ",", "1", ",", "6", ",", "2", ",", 
           "9", ",", "4", ",", "8", ",", "5", ",", "5", ",", "6", ",", "5", 
           ",", "0", ",", "5", ",", "6", ",", "2", ",", "4", ",", "1", ",", 
           "7", ",", "8", ",", "7", ",", "0", ",", "3", ",", "0", ",", "7", 
           ",", "6", ",", "2", ",", "3", ",", "7", ",", "1", ",", "2", ",", 
           "3"}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{65., {3., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLText",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{52., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{52., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 10, 30264874653658789060, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{62., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{62., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 10, 30264874653658789060, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 10, 30264874653658789060, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{78., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[30264874653658789060 === $SessionID, 
   Out[10], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.7392396944188795`*^9, 3.739239714894294*^9}},
 CellLabel->"Out[10]=",ExpressionUUID->"8cc5750d-1b3f-4fc0-a66b-1f40e737ec2d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"tt", "  ", "=", " ", 
   RowBox[{"training", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"54805a5a-4b87-4ec6-adb6-4936c91c1f1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ty", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"60000", ",", " ", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", "60000"}], ",", " ", 
    RowBox[{"i", "++"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"ty", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", 
         RowBox[{"1", "+", 
          RowBox[{"tt", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], " ", "=", " ", 
      "1"}], ";"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7392397332790203`*^9, 3.739239736720055*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"a59f3577-da47-44f8-914f-83a621f84900"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7392396856983795`*^9, 
  3.7392396877726808`*^9}},ExpressionUUID->"9f38afbc-f656-4da5-a982-\
925c7907c277"],

Cell[BoxData[
 RowBox[{"{", "60000", "}"}]], "Output",
 CellChangeTimes->{{3.739239658497732*^9, 3.7392396829990187`*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"6c8de676-0225-4dd8-a53f-01bd560242da"]
}, Open  ]]
},
WindowSize->{958, 1028},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 7, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 838, 20, 28, "Input",ExpressionUUID->"ed9aac8d-2a98-4de2-8077-50d136f16962"],
Cell[1421, 44, 713, 17, 32, "Output",ExpressionUUID->"97db5fd5-a5f1-4331-b506-4986a2073679"]
}, Open  ]],
Cell[2149, 64, 297, 7, 28, "Input",ExpressionUUID->"2dbf051b-6794-4698-8118-162650303536"],
Cell[2449, 73, 613, 15, 28, "Input",ExpressionUUID->"d57d0057-fe9a-4da0-9f04-120c71ce74a7"],
Cell[3065, 90, 159, 3, 31, "Item",ExpressionUUID->"b56e90d2-1c5d-4473-8b05-17413a12a660"],
Cell[3227, 95, 485, 10, 28, "Input",ExpressionUUID->"acb2f457-f421-42d4-8830-3e4963faaf61"],
Cell[3715, 107, 376, 9, 28, "Input",ExpressionUUID->"abdfd562-ad5d-4eb0-951c-8eafa6924402"],
Cell[4094, 118, 474, 12, 28, "Input",ExpressionUUID->"20ace5f3-c91b-4613-89ef-827d827ac0d1"],
Cell[4571, 132, 150, 3, 31, "Item",ExpressionUUID->"e9160ad1-42b4-4836-8a14-2a7090eabea3"],
Cell[4724, 137, 665, 16, 48, "Input",ExpressionUUID->"0d14c289-5af1-4794-b1e4-8127b6b829cf"],
Cell[CellGroupData[{
Cell[5414, 157, 297, 6, 28, "Input",ExpressionUUID->"6e78d7f6-b2f0-49ce-8353-83c9882d5a3f"],
Cell[5714, 165, 426, 10, 23, "Message",ExpressionUUID->"cbc04d72-bb45-4b63-83c7-4257479189b2"],
Cell[6143, 177, 377, 11, 32, "Output",ExpressionUUID->"d959b0c6-422d-475c-9477-cbb1ce6fa7dd"]
}, Open  ]],
Cell[6535, 191, 151, 3, 31, "Item",ExpressionUUID->"cfbb2f93-258d-4f8c-b0db-bb3f6a7d31fe"],
Cell[6689, 196, 784, 20, 48, "Input",ExpressionUUID->"2d8380fd-307a-4dee-9876-a4e01f596aad"],
Cell[CellGroupData[{
Cell[7498, 220, 469, 14, 28, "Input",ExpressionUUID->"8f97cd7e-a668-416a-8e15-c8b38fa1f560"],
Cell[7970, 236, 366, 10, 32, "Output",ExpressionUUID->"dfbb809c-17d6-4b07-8014-c45184426ac3"]
}, Open  ]],
Cell[8351, 249, 317, 8, 28, "Input",ExpressionUUID->"cb221f5c-69a2-4b75-b7c8-93dd136b9e11"],
Cell[8671, 259, 934, 24, 48, "Input",ExpressionUUID->"25d958e1-0696-4199-8c75-01de0bcd3f1f"],
Cell[9608, 285, 460, 11, 28, "Input",ExpressionUUID->"3cfd9ca1-86ba-4b52-9a75-08d99d0372d2"],
Cell[10071, 298, 1338, 38, 86, "Input",ExpressionUUID->"52653755-6bb6-4a13-8848-ebe5507ef5c9"],
Cell[CellGroupData[{
Cell[11434, 340, 273, 5, 28, "Input",ExpressionUUID->"88f19372-da0f-4b0e-baf3-21c005bac762"],
Cell[11710, 347, 1150, 30, 52, "Output",ExpressionUUID->"c3c87551-5e35-4c71-9515-5ba942e939b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12897, 382, 414, 8, 28, "Input",ExpressionUUID->"2c5943db-387a-43e2-88ee-461d934a61bc"],
Cell[13314, 392, 220, 4, 32, "Output",ExpressionUUID->"998c4393-f30a-4212-9970-10b1da61a6fa"]
}, Open  ]],
Cell[13549, 399, 384, 9, 28, "Input",ExpressionUUID->"0455c996-f8c8-4893-a607-bb8e2c5ca565"],
Cell[13936, 410, 539, 13, 28, "Input",ExpressionUUID->"36a3c81d-c1e1-42e5-be40-a439de3b31c7"],
Cell[CellGroupData[{
Cell[14500, 427, 206, 3, 28, "Input",ExpressionUUID->"309c1011-41ef-4f60-bcdf-327c677dd8b9"],
Cell[14709, 432, 200, 4, 32, "Output",ExpressionUUID->"9ced27a7-4ebb-42d9-9dd7-af14217a845a"]
}, Open  ]],
Cell[14924, 439, 469, 13, 48, "Input",ExpressionUUID->"d2039697-8ec7-4bf7-8098-6b80b442002e"],
Cell[15396, 454, 648, 19, 28, "Input",ExpressionUUID->"d3e07553-3583-4f8a-ada6-203ccf61bd97"],
Cell[16047, 475, 383, 9, 28, "Input",ExpressionUUID->"d8787ba7-b85c-4184-a279-8dcda3ca5db4"],
Cell[CellGroupData[{
Cell[16455, 488, 263, 5, 28, "Input",ExpressionUUID->"66931c41-ea79-40d5-83f1-810e8b2d543c"],
Cell[16721, 495, 10230, 237, 200, "Output",ExpressionUUID->"8cc5750d-1b3f-4fc0-a66b-1f40e737ec2d"]
}, Open  ]],
Cell[26966, 735, 251, 6, 28, "Input",ExpressionUUID->"54805a5a-4b87-4ec6-adb6-4936c91c1f1d"],
Cell[27220, 743, 851, 24, 48, "Input",ExpressionUUID->"a59f3577-da47-44f8-914f-83a621f84900"],
Cell[CellGroupData[{
Cell[28096, 771, 156, 3, 28, "Input",ExpressionUUID->"9f38afbc-f656-4da5-a982-925c7907c277"],
Cell[28255, 776, 200, 3, 32, "Output",ExpressionUUID->"6c8de676-0225-4dd8-a53f-01bd560242da"]
}, Open  ]]
}
]
*)

